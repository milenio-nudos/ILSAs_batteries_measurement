axis.labels = c("edit_photos", "edit_text", "search_info",
"change_settings", "create_pres", "upload_media", "insert_image", "install_app", "eval_info", "find_source"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "none")
a
frq(icils$IS3G24I)
icils_2023_proc <- readRDS("~/GitHub/ILSAs_batteries_measurement/data/proc_data/icils_2023_proc.rds")
frq(icils_2023_proc$IS3G24I)
icils23_proc <- readRDS("~/GitHub/ILSAs_batteries_measurement/data/proc_data/icils23_proc.rds")
icils23_proc$IS3G24I <- car::recode(icils23_proc$IS3G24I, "c(1)=4; c(2)=3; c(3)=2; c(4)=1")
frq(icils23_proc$IS3G24I)
saveRDS(icils23_proc, "data/proc_data/icils23_proc.rds")
icils <- readRDS("data/proc_data/icils23_proc.rds")
a <- icils %>%
select(IS3G24A, IS3G24B, IS3G24C, IS3G24E, IS3G24F,
IS3G24G, IS3G24H, IS3G24I, IS3G24J, IS3G24M) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("General (n = 135.615)"),
geom.size = 0.8,
axis.labels = c("edit_photos", "edit_text", "search_info",
"change_settings", "create_pres", "upload_media", "insert_image", "install_app", "eval_info", "find_source"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "none")
a
b <- icils %>%
select(IS3G24D, IS3G24K, IS3G24L) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Specialized"),
geom.size = 0.8,
axis.labels = c("build_page", "write_code", "devel_program"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
liker_icils <- a/b
liker_icils
b <- icils %>%
select(IS3G24D, IS3G24K, IS3G24L) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Specialized"),
sort.frq = "pos.desc",
geom.size = 0.8,
axis.labels = c("build_page", "write_code", "devel_program"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
b
a <- icils %>%
select(IS3G24A, IS3G24B, IS3G24C, IS3G24E, IS3G24F,
IS3G24G, IS3G24H, IS3G24I, IS3G24J, IS3G24M) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("General (n = 135.615)"),
sort.frq = "pos.desc",
geom.size = 0.8,
axis.labels = c("edit_photos", "edit_text", "search_info",
"change_settings", "create_pres", "upload_media", "insert_image", "install_app", "eval_info", "find_source"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "none")
a
liker_icils <- a/b
liker_icils
View(icils)
View(icils)
M <- psych::polychoric(icils_2023[c(3:15)])
M <- psych::polychoric(icils23[c(3:15)])
M <- psych::polychoric(icils[c(3:15)])
P <- cor(icils[c(3:15)], method = "pearson")
diag(M$rho) <- NA
diag(P) <- NA
M$rho[9,] <- P[9,]
rownames(M$rho) <- c("edit_photos (A)",
"edit_text (B)",
"search_info (C)",
"build_page (D)",
"change_settings (E)",
"create_pres (F)",
"upload_media (G)",
"insert_image (H)",
"install_app (I)",
"eval_info (J)",
"write_code (K)",
"devel_program (L)",
"find_source (M)")
#set Column names of the matrix
colnames(M$rho) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)")
rownames(P) <- c("edit_photos (A)",
"edit_text (B)",
"search_info (C)",
"build_page (D)",
"change_settings (E)",
"create_pres (F)",
"upload_media (G)",
"insert_image (H)",
"install_app (I)",
"eval_info (J)",
"write_code (K)",
"devel_program (L)",
"find_source (M)")
#set Column names of the matrix
colnames(P) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)")
testp <- cor.mtest(M$rho, conf.level = 0.95)
corrplot::corrplot(M$rho,
method = "color",
addCoef.col = "black",
type = "upper",
tl.col = "black",
col = colorRampPalette(c("#E16462", "white", "#0D0887"))(12),
bg = "white",
na.label = "-")
icils <- readRDS("data/proc_data/icils23_proc.rds")
M <- psych::polychoric(icils[c(3:15)])
P <- cor(icils[c(3:15)], method = "pearson")
diag(M$rho) <- NA
diag(P) <- NA
rownames(M$rho) <- c("edit_photos (A)",
"edit_text (B)",
"search_info (C)",
"build_page (D)",
"change_settings (E)",
"create_pres (F)",
"upload_media (G)",
"insert_image (H)",
"install_app (I)",
"eval_info (J)",
"write_code (K)",
"devel_program (L)",
"find_source (M)")
#set Column names of the matrix
colnames(M$rho) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)")
rownames(P) <- c("edit_photos (A)",
"edit_text (B)",
"search_info (C)",
"build_page (D)",
"change_settings (E)",
"create_pres (F)",
"upload_media (G)",
"insert_image (H)",
"install_app (I)",
"eval_info (J)",
"write_code (K)",
"devel_program (L)",
"find_source (M)")
#set Column names of the matrix
colnames(P) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)")
testp <- cor.mtest(M$rho, conf.level = 0.95)
#Plot the matrix using corrplot
corrplot::corrplot(M$rho,
method = "color",
addCoef.col = "black",
type = "upper",
tl.col = "black",
col = colorRampPalette(c("#E16462", "white", "#0D0887"))(12),
bg = "white",
na.label = "-")
pisa <- readRDS("data/proc_data/pisa22proc.rds")
pisa <- readRDS("data/proc_data/pisa22_proc.rds")
pisa <- pisa %>%
select(IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA)
View(pisa)
View(pisa)
get_label(pisa$IC183Q16JA)
c <- pisa %>%
select(IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA ) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Items (n = )"),
geom.size = 0.8,
axis.labels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
c
c <- pisa %>%
select(IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA ) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Digital self-efficacy (n = 393.607)"),
geom.size = 0.8,
axis.labels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
c
c <- pisa %>%
select(IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA ) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Digital self-efficacy (n = 393.607)"),
sort.frq = "pos.desc"
geom.size = 0.8,
c <- pisa %>%
select(IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA ) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Digital self-efficacy (n = 393.607)"),
sort.frq = "pos.desc",
geom.size = 0.8,
axis.labels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
c
c <- pisa %>%
select(IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA ) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Digital self-efficacy (n = 393.607)"),
sort.frq = "pos.desc",
geom.size = 0.8,
axis.labels = c("search_info", "asses_info", "share_info", "pair_collab",
"explain_howtoshare", "edit_text", "collect_data", "create_pres",
"page_web", "change_settings", "select_app", "create_program",
"identify_error", "logical_solution"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
c
Mp <- psych::polychoric(pisa)
# Bivariados
rm(Mp)
Mp <- psych::polychoric(pisa[c(1:14)])
Pp <- cor(pisa[c(1:14)], method = "pearson")
diag(Mp$rho) <- NA
diag(Pp) <- NA
rownames(Mp$rho) <- c("search_info (A)",
"asses_info (B)",
"share_info (C)",
"pair_collab (D)",
"explain_howtoshare (E)",
"edit_text (F)",
"collect_data (G)",
"create_pres (H)",
"page_web (I)",
"change_settings (J)",
"select_app (K)",
"create_program (L)",
"identify_error (M)",
"logical_solution (N)")
#set Column names of the matrix
colnames(M$rho) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)", "(N)")
#set Column names of the matrix
colnames(Mp$rho) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)", "(N)")
rownames(Pp) <- c("search_info (A)",
"asses_info (B)",
"share_info (C)",
"pair_collab (D)",
"explain_howtoshare (E)",
"edit_text (F)",
"collect_data (G)",
"create_pres (H)",
"page_web (I)",
"change_settings (J)",
"select_app (K)",
"create_program (L)",
"identify_error (M)",
"logical_solution (N)")
#set Column names of the matrix
colnames(Pp) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)", "(N)")
testpp <- cor.mtest(Mp$rho, conf.level = 0.95)
#Plot the matrix using corrplot
corrplot::corrplot(Mp$rho,
method = "color",
addCoef.col = "black",
type = "upper",
tl.col = "black",
col = colorRampPalette(c("#E16462", "white", "#0D0887"))(12),
bg = "white",
na.label = "-")
#| label: fig-corr-pisa
#| echo: false
#| fig-cap: PISA correlations
#| fig-cap-location: bottom
Mp <- psych::polychoric(pisa[c(1:14)])
Pp <- cor(pisa[c(1:14)], method = "pearson")
diag(Mp$rho) <- NA
diag(Pp) <- NA
rownames(Mp$rho) <- c("search_info (A)",
"asses_info (B)",
"share_info (C)",
"pair_collab (D)",
"explain_howtoshare (E)",
"edit_text (F)",
"collect_data (G)",
"create_pres (H)",
"page_web (I)",
"change_settings (J)",
"select_app (K)",
"create_program (L)",
"identify_error (M)",
"logical_solution (N)")
#set Column names of the matrix
colnames(Mp$rho) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)", "(N)")
rownames(Pp) <- c("search_info (A)",
"asses_info (B)",
"share_info (C)",
"pair_collab (D)",
"explain_howtoshare (E)",
"edit_text (F)",
"collect_data (G)",
"create_pres (H)",
"page_web (I)",
"change_settings (J)",
"select_app (K)",
"create_program (L)",
"identify_error (M)",
"logical_solution (N)")
#set Column names of the matrix
colnames(Pp) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)",
"(H)","(I)", "(J)", "(K)", "(L)", "(M)", "(N)")
testpp <- cor.mtest(Mp$rho, conf.level = 0.95)
#Plot the matrix using corrplot
corrplot::corrplot(Mp$rho,
method = "color",
addCoef.col = "black",
type = "upper",
tl.col = "black",
col = colorRampPalette(c("#E16462", "white", "#0D0887"))(12),
bg = "white",
number.digits = 2,
na.label = "-")
#| label: Measurement model
model_cfa <- '
gen_dse = ~ IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q12JA, IC183Q13JA
spec_dse = ~ IC183Q10JA, IC183Q14JA, IC183Q15JA, IC183Q16JA
'
m_cfa <- cfa(model = model_cfa,
data = pisa,
estimator = "DWLS",
ordered = T,
std.lv = F)
#| label: libraries
pacman::p_load(
dplyr, haven, sjlabelled,  psych,  purrr,  tidyr,  sjPlot,  ggplot2,
parameters,  table1,  car,  beeswarm,  lme4, scales, ggrepel, corrplot,
ggtext, patchwork, lavaan)
options(scipen = 999)
rm(list = ls())
#| include: false
library(knitr)
knitr::opts_chunk$set(echo = TRUE, include = TRUE, warning = FALSE, message = FALSE)
table_format <- if(is_html_output()) {
"html"
} else if(is_latex_output()) {
"latex"
}
table_format2 <- if(is_html_output()) {
T
} else if(is_latex_output()) {
F
}
options(kableExtra.html.bsTable = T)
options(knitr.kable.NA = "")
#| label: data
icils <- readRDS("../data/proc_data/icils23_proc.rds")
#| label: Measurement model
model_cfa <- '
gen_dse = ~ IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q12JA, IC183Q13JA
spec_dse = ~ IC183Q10JA, IC183Q14JA, IC183Q15JA, IC183Q16JA
'
m_cfa <- cfa(model = model_cfa,
data = pisa,
estimator = "DWLS",
ordered = T,
std.lv = F)
#| label: data
icils <- readRDS("../data/proc_data/icils23_proc.rds")
#| label: data
icils <- readRDS("data/proc_data/icils23_proc.rds")
pisa <- readRDS("data/proc_data/pisa22_proc.rds")
#| label: Measurement model
model_cfa <- '
gen_dse = ~ IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q12JA, IC183Q13JA
spec_dse = ~ IC183Q10JA, IC183Q14JA, IC183Q15JA, IC183Q16JA
'
m_cfa <- cfa(model = model_cfa,
data = pisa,
estimator = "DWLS",
ordered = T,
std.lv = F)
model_cfa <- '
gen_dse = ~ IC183Q01JA + IC183Q02JA + IC183Q03JA + IC183Q04JA + IC183Q05JA +
IC183Q07JA + IC183Q08JA + IC183Q09JA + IC183Q12JA + IC183Q13JA
spec_dse = ~ IC183Q10JA + IC183Q14JA + IC183Q15JA + IC183Q16JA
'
m_cfa <- cfa(model = model_cfa,
data = pisa,
estimator = "DWLS",
ordered = T,
std.lv = F)
cnames <- c("Factor","Indicator","Loading (DWLS)")
kable(left_join(x = standardizedsolution(m_cfa) %>%
filter(op=="=~") %>%
select(lhs,rhs,est.std),
format = "markdown",digits = 2,col.names = cnames, caption = "Factor loadings")
factor_loadings <- standardizedsolution(m_cfa) %>%
standardizedsolution(m_cfa) %>%
filter(op == "=~") %>%
select(Factor = lhs, Indicator = rhs, `Loading (DWLS)` = est.std) %>%
kable(format = "markdown", digits = 2, caption = "Factor loadings")
m2_cfa <- cfa(model_cfa, data=pisa)
summary(m2_cfa, fit.measures=TRUE, standardized=TRUE)
pisa22_proc <- readRDS("~/GitHub/ILSAs_batteries_measurement/data/proc_data/pisa22_proc.rds")
pisa22 <- readRDS("data/proc_data/pisa22ict.rds")
pisa22_proc <- pisa22 %>%
select(CNT, CNTRYID, CNTSCHID, IC183Q01JA, IC183Q02JA, IC183Q03JA, IC183Q04JA,
IC183Q05JA, IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA,
IC183Q12JA, IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA)
pisa22_proc <- pisa22_proc %>% rename("search_info"=IC183Q01JA,
"asses_info"=IC183Q02JA,
"share_info"=IC183Q03JA,
"pair_collab"=IC183Q04JA,
"how_to_share"=IC183Q05JA,
"edit_text"=IC183Q07JA,
"collect_data"=IC183Q08JA,
"create_pres"=IC183Q09JA,
"page_web"=IC183Q10JA,
"change_settings"=IC183Q12JA,
"select_app"=IC183Q13JA,
"create_program"=IC183Q14JA,
"identify_error"=IC183Q15JA,
"logical_solution"=IC183Q16JA)
View(pisa22_proc)
saveRDS(pisa22_proc, "data/proc_data/pisa22_proc.rds")
#| label: fig-descr-pisa
#| echo: true
#| fig-cap: Digital self-efficacy PISA
#| fig-cap-location: bottom
c <- pisa %>%
select(search_info, asses_info, share_info, IC183Q04JA, IC183Q05JA,
IC183Q07JA, IC183Q08JA, IC183Q09JA, IC183Q10JA, IC183Q12JA,
IC183Q13JA, IC183Q14JA, IC183Q15JA, IC183Q16JA) %>%
sjPlot::plot_likert(geom.colors = "Reds",
title = c("Digital self-efficacy (n = 393.607)"),
sort.frq = "pos.desc",
geom.size = 0.8,
axis.labels = c("search_info", "asses_info", "share_info",    "pair_collab",
"explain_howtoshare", "edit_text", "collect_data", "create_pres",
"page_web", "change_settings", "select_app", "create_program",
"identify_error", "logical_solution"),
catcount = 4,
values  =  "sum.outside",
reverse.colors = F,
reverse.scale = T,
show.n = FALSE,
show.prc.sign = T
) +
ggplot2::theme(legend.position = "bottom")
